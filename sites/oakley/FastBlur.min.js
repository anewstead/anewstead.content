function boxBlurImage(a,e,t,r,o){var l=document.getElementById(a),n=l.naturalWidth,c=l.naturalHeight,g=document.getElementById(e);g.style.width=n+"px",g.style.height=c+"px",g.width=n,g.height=c;var s=g.getContext("2d");s.clearRect(0,0,n,c),s.drawImage(l,0,0),isNaN(t)||1>t||(r?boxBlurCanvasRGBA(e,0,0,n,c,t,o):boxBlurCanvasRGB(e,0,0,n,c,t,o))}function boxBlurCanvasRGBA(a,e,t,r,o,l,n){if(!(isNaN(l)||1>l)){l|=0,isNaN(n)&&(n=1),n|=0,n>3&&(n=3),1>n&&(n=1);var c,g=document.getElementById(a),s=g.getContext("2d");try{try{c=s.getImageData(e,t,r,o)}catch(i){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),c=s.getImageData(e,t,r,o)}catch(i){throw alert("Cannot access local image"),new Error("unable to access local image data: "+i)}}}catch(i){throw alert("Cannot access image"),new Error("unable to access image data: "+i)}for(var m,u,d,h,f,b,v,B,y,w,I,C,x,N,E=c.data,R=r-1,p=o-1,D=l+1,_=mul_table[l],G=shg_table[l],P=[],A=[],M=[],U=[],H=[],W=[];n-->0;){for(x=C=0,b=0;o>b;b++){for(m=E[x]*D,u=E[x+1]*D,d=E[x+2]*D,h=E[x+3]*D,v=1;l>=v;v++)B=x+((v>R?R:v)<<2),m+=E[B++],u+=E[B++],d+=E[B++],h+=E[B];for(f=0;r>f;f++)P[C]=m,A[C]=u,M[C]=d,U[C]=h,0==b&&(H[f]=((B=f+D)<R?B:R)<<2,W[f]=(B=f-l)>0?B<<2:0),y=x+H[f],w=x+W[f],m+=E[y++]-E[w++],u+=E[y++]-E[w++],d+=E[y++]-E[w++],h+=E[y]-E[w],C++;x+=r<<2}for(f=0;r>f;f++){for(I=f,m=P[I]*D,u=A[I]*D,d=M[I]*D,h=U[I]*D,v=1;l>=v;v++)I+=v>p?0:r,m+=P[I],u+=A[I],d+=M[I],h+=U[I];for(C=f<<2,b=0;o>b;b++)E[C+3]=N=h*_>>>G,N>0?(N=255/N,E[C]=(m*_>>>G)*N,E[C+1]=(u*_>>>G)*N,E[C+2]=(d*_>>>G)*N):E[C]=E[C+1]=E[C+2]=0,0==f&&(H[b]=((B=b+D)<p?B:p)*r,W[b]=(B=b-l)>0?B*r:0),y=f+H[b],w=f+W[b],m+=P[y]-P[w],u+=A[y]-A[w],d+=M[y]-M[w],h+=U[y]-U[w],C+=r<<2}}s.putImageData(c,e,t)}}function boxBlurCanvasRGB(a,e,t,r,o,l,n){if(!(isNaN(l)||1>l)){l|=0,isNaN(n)&&(n=1),n|=0,n>3&&(n=3),1>n&&(n=1);var c,g=document.getElementById(a),s=g.getContext("2d");try{try{c=s.getImageData(e,t,r,o)}catch(i){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),c=s.getImageData(e,t,r,o)}catch(i){throw alert("Cannot access local image"),new Error("unable to access local image data: "+i)}}}catch(i){throw alert("Cannot access image"),new Error("unable to access image data: "+i)}for(var m,u,d,h,f,b,v,B,y,w,I,C,x=c.data,N=r-1,E=o-1,R=l+1,p=[],D=[],_=[],G=mul_table[l],P=shg_table[l],A=[],M=[];n-->0;){for(C=I=0,f=0;o>f;f++){for(m=x[C]*R,u=x[C+1]*R,d=x[C+2]*R,b=1;l>=b;b++)v=C+((b>N?N:b)<<2),m+=x[v++],u+=x[v++],d+=x[v++];for(h=0;r>h;h++)p[I]=m,D[I]=u,_[I]=d,0==f&&(A[h]=((v=h+R)<N?v:N)<<2,M[h]=(v=h-l)>0?v<<2:0),B=C+A[h],y=C+M[h],m+=x[B++]-x[y++],u+=x[B++]-x[y++],d+=x[B++]-x[y++],I++;C+=r<<2}for(h=0;r>h;h++){for(w=h,m=p[w]*R,u=D[w]*R,d=_[w]*R,b=1;l>=b;b++)w+=b>E?0:r,m+=p[w],u+=D[w],d+=_[w];for(I=h<<2,f=0;o>f;f++)x[I]=m*G>>>P,x[I+1]=u*G>>>P,x[I+2]=d*G>>>P,0==h&&(A[f]=((v=f+R)<E?v:E)*r,M[f]=(v=f-l)>0?v*r:0),B=h+A[f],y=h+M[f],m+=p[B]-p[y],u+=D[B]-D[y],d+=_[B]-_[y],I+=r<<2}}s.putImageData(c,e,t)}}var mul_table=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shg_table=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18];